# 2.7 - 诊断工具

2.7 - 诊断工具

FormIt 附带了一些有用的内置模型诊断工具，可帮助保持模型干净和正常，包括检查无间隙几何图形、标识翻转面以及同时查看所有组边界框。

_在本章中，我们将识别并修复_ _**“Encode Campus Sample Model.axm”**中存在的一些错误。如果尚未下载，可以从_ _**“FormIt Primer Part 2 数据集”**下载文件。_

_有关修复模型的详细信息，请访问_ [_**修复实体模型**_](https://formit.autodesk.com/blog/post/repairing-solid-models) _FormIt 博客贴子。_

## 确定无间隙问题

_无间隙模型或组是没有间隙、边杂散或带有其他_ [_**非流形几何图形**_](https://knowledge.autodesk.com/zh-hans/support/maya/learn-explore/caas/CloudHelp/cloudhelp/2016/CHS/Maya/files/GUID-8E97CEF7-1CFE-4838-B4B7-59F526E21AB2-htm.html)_ 的实体对象。检查无间隙可能对于以下各个方面很重要：计算体积、运行精确的日光和能量分析、将模型输出为其他文件格式以及为三维打印或制造准备模型。_

1 - 打开**“Encode Campus Sample Model.axm”**后，我们将调整图层可见性以隔离要检查无间隙的几何图形：

1. 打开**“图层选项板”**。
2. 通过单击图层列表内的任意位置并按 **Ctrl+A** 组合键，选中所有图层。
3. 单击当前打开的任意图层复选框，所有图层都将关闭。
4. 在“图层选项板”顶部附近的**“过滤器”**输入框中，开始键入**“外部砌体”**，直到仅见到我们想要的图层。
5. 单击该复选框，以打开**“编码主建筑物 - 外部砌体”**图层。
6. 在**“浮动导航栏”**中，单击**“全部缩放(ZA)”**按钮。现在，您应该只看到主建筑物的外砖墙。

![](<../../.gitbook/assets/0 (18).png>)

![](<../../.gitbook/assets/1 (8).png>)

2 - 现在，我们检查是否存在任何无间隙问题！

1. 打开**“视觉样式选项板”**。
2. 选择右上角的**“模型诊断”**选项卡（扳手图标）。
3. 选中**“确定无间隙问题”**旁边的框。
4. 任何无间隙问题都将以红色亮显。在本例中，有两个无间隙问题，一个沿墙的整个顶面和一个小的等级库（它实际位于建筑物后立面的窗台上）。
5. 在解决这些问题之前，请选择**“外部砌体”**组、打开**“特性选项板”**，请注意**“体积”**特性显示为**“0 立方英尺”**。这是因为该组存在间隙，因此无法计算其体积。

![](<../../.gitbook/assets/2 (16).png>)

_**注意：**_ _红色无间隙问题亮显可在任何模型材质（不透明或透明）中见到，从而使其易于查找。_

![](<../../.gitbook/assets/3 (5) (1).png>)

3 - 现在，我们已发现无间隙问题，可以解决它们。首先，我们将处理墙的顶面。

1. 双击**“外部砌体”**组以对其进行编辑，然后放大并选择墙的顶面。在**“特性选项板”**中，请注意，墙的顶面实际上是其自己的组。在 FormIt 中，无间隙几何图形必须由单个组构成，这就是我们看到这些红色\*\*\*\*线的原因。
2. 要解决此问题，只需**“解组(U)”**选定面，砖墙顶部周围的红线应该会消失。

![](../../.gitbook/assets/watertightness\_8\_fixed\_combined\_annotated.png)

_**注意：**_ _还可以通过选定几何图形周围的蓝色虚线边框，快速判断已选中分组的几何图形。已解组的面和边将不具有此特性。_

4 - 现在，我们处理仍以红色亮显的其他较小无间隙问题。

1. 缩放并旋转模型，直到可以清楚地看到较小三角形间隙。区域（存在无间隙问题），以便可以看到三角形间隙。
2. 在仍处于组编辑模式下时，使用**“直线(L)”**工具跟踪跨三角形孔的一条较长边的直线，然后按 **Esc** 键两次以退出直线工具。

![](<../../.gitbook/assets/5 (9).png>)

_**注意：**_ _FormIt 会在绘制一条线后自动创建一个曲面，来填充三角形间隙。只要跟踪或完成共面的一组线，就会发生这种情况。_

5 - 红色无间隙线现在应该已消失。为了完成操作，我们将删除其余不需要的边，然后重新检查组的体积：

1. 要删除不需要的边，请尝试使用**“合并(MG)”**工具。此工具将连接任何共面的曲面，并一键删除所有额外的边。要执行此操作，请双击砖墙以选中其所有曲面和边，然后单击鼠标右键以显示关联菜单并选择**“合并(MG)”**。
2. 按 **Esc** 键或 **F** 键以完成操作并退出组编辑。然后，单击**“外部砌体”**组以再次选中它，并重新打开**“特性选项板”**（如果尚未打开）。
3. 现在，组已无间隙，FormIt 可以为我们计算墙的**“体积”**！

![](<../../.gitbook/assets/6 (10).png>)

_**注意：**_ __ _**“确定无间隙问题”**以及检查实体中是否存在问题，也可用于帮助查找模型上存在的任何杂散边 - 尝试一下！_

6 - 完成后，请勿忘记关闭**“确定无间隙问题”**，否则模型中存在的每一条杂散边都将以红色亮显！

## 确定背面

_在 FormIt 中，使用材质绘制曲面时，它会自动应用于两侧。但是，其他三维建模和可视化软件可能会根据可见的侧（“前”或“后”）以不同方式渲染曲面。幸运的是，FormIt 有一种简单的方法来对这一情况进行检查！_

1 - 我们看一下现有的**“NE 建筑物”**。转到**“场景选项板”**，然后双击**“默认可见性”**场景以重置图层可见性。

2 - 这次不使用图层，而是双击**“NE 建筑物”**组进行编辑，然后再次双击其**“外部砌体”**组进行编辑。

3 - 环绕视图，直到可以看到该建筑物的前立面，然后启用**“隐藏组上下文(H)”**，以便您只看到砖墙。现在，我们可以检查是否有任何背面可见：

1. 再次打开**“视觉样式选项板”**。
2. 如果尚未选择，请单击右上角的**“模型诊断”**按钮（扳手图标）。
3. 如果尚未选择，请取消选中**“确定无间隙问题”**复选框，然后改为激活**“确定背面”**复选框。

![](<../../.gitbook/assets/7 (2).png>)

4 - 有 (3) 个背面以 FormIt 的默认“背面”颜色亮显，但由于其与砖材质的相似性，因此难以看到它们。为了解决此问题，我们可以启用**“单调曲面”**：

1. 要显示曲面视觉样式选项，请在**“视觉样式选项板”**中单击左上角的**“曲面”**按钮（实心立方体图标）。
2. 选中**“单调曲面”**旁边的框。现在，背面更容易看到。

![](<../../.gitbook/assets/8 (4).png>)

_**注意：**_ _启用后，_ _**“曲面”**_ _选项卡中的_ _**“背面”**_ _复选框和颜色（不会与_ _**“确定背面”**_ _诊断工具混淆）允许用户使用不同的材质绘制面的两侧。未指定材质的背面将使用在_ _**“背面”**_ _复选框右侧的框中设置的任何颜色进行着色。默认情况下，当使用从软件输入的几何图形时，将激活这一选项：默认允许面的对侧可以有不同的材质，如 SketchUp。_

5 - 只需翻转“背”面，以便我们仅看到前面。双击**“外部砌体”**组以进行编辑，并针对每个背面进行以下操作：

1. 放大，并在背面上单击鼠标邮件以显示**“关联菜单”**。
2. 选择**“反转面(FF)”**，或键入键盘快捷键**“FF”**。

![](<../../.gitbook/assets/9 (2).png>)

_**注意：**_ _还可以在按住_ _**Ctrl**_ _或_ _**Shift**_ _键的同时，单击每个背面以将它们全部选中，然后通过按_ _**FF** 键一次翻转所有背面。_

6 - 不要忘记禁用**“单调曲面”**和**“确定背面”**，以再次查看常规材质。

## 显示组边界框

_此工具允许您同时查看模型中所有组的边界框，而不管其图层当前是否可见。这可以帮助您快速确定其范围远大于所需范围的组，以及轴方向不同的组。_

1 - 使模型中的所有组边界框可见的步骤：

1. 打开**“视觉样式选项板”**。
2. 选择右上角的**“模型诊断”**按钮（扳手图标）。
3. 激活**“显示组边界框”**复选框，然后取消选中所有仍处于选中状态的其他复选框。
4. 使用鼠标滚轮或通过单击**“浮动导航工具栏”**中的**“缩放(Z)”**工具进行缩小，直到可以在画布上看到所有蓝色虚线边界框。
5. 即使大多数图层仍处于关闭状态，请注意，我们仍可以看到一个看起来不必要那么大的组边界框！

![](<../../.gitbook/assets/10 (4).png>)

_**注意：**_ _此视图中的某些边界框处于不同角度。组的边界框沿该组轴定向，因此快速判断组内部轴基本方向的方法是查看其边界框。_

2 - 要找出使边界框如此之大的原因，让我们使用预制场景打开所有图层并尝试解决问题：

1. 打开**“场景”** **选项板**。
2. 双击名为**“默认可见性”**的场景，以重新打开所有主图层。
3. 是否在最大边界框的远角处看到垂直线？双击该线以编辑其所在的组、选择线，然后删除。然后，退出该组。

![](<../../.gitbook/assets/11 (4).png>)

3 - 现在，当我们查看所有组边界框时，没有比模型几何图形大得多的边界框。

![](<../../.gitbook/assets/12 (5).png>)
