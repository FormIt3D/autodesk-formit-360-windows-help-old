# 2.5 - プラグイン

FormIt には、組み込み機能を拡張する複数のプラグインが用意されています。また、AEC コミュニティによって開発されたプラグインをインストールしたり、独自のプラグインを作成することもできます。

_この章では、FormIt に付属のプラグインをいくつか紹介して、_ _**Encode Campus Sample Model.axm**に改善を加えます。まだダウンロードしていない場合は、_ _**FormIt Primer Part 2 Dataset**からファイルをダウンロードできます。_

## プラグインをインストールする

1 - **Encode Campus Sample Model.axm** を開いたら、次の手順で最初のプラグインをインストールします。

1. プラグ アイコンをクリックして、**[プラグイン マネージャ]パレット**を開きます。
2. **[推奨]**ドロップダウンを展開します。
3. 下にスクロールしてプラグイン **Generate String Lights** を見つけ、プラグイン名の右側にあるスライダをクリックしてインストールします。
4. プラグがインストールされると、そのパレットが自動的に開きます。
5. 新しいアイコンは、他のすべてのパレット アイコンの下にも表示されます。

![](../../.gitbook/assets/install-plugins_0_annotated%20%281%29.png)

![](../../.gitbook/assets/install-plugins_1_annotated.png)

2 - **[プラグイン マネージャ]パレット**を再度開いてこのプロセスを 2 回繰り返し、プラグイン **Manage Cameras** および **Properties Plus** をインストールします。

3 - 3 つのプラグインがすべて正常にインストールされたことを確認します。

1. **[推奨]**ドロップダウンを最小化し、**[インストール済み]**ドロップダウンを展開します。この方法で、インストールされているプラグインのみを簡単に表示できます。
2. すべてではありませんがほとんどのプラグインには独自のアイコンがあり、パレット アイコン ツールバーに追加されているはずです。いつでも**[プラグイン マネージャ]パレット**に戻ってプラグインのスライダのオンとオフを切り替えることができ、プラグインとそのアイコンを FormIt セッションで追加または削除できます。
3. インストールされているプラグインのアイコンが多すぎて画面に収まらない場合は、**[ウィンドウ]**ドロップダウン(メインの**メニュー バー**)で未使用のプラグイン アイコンの表示をオフにすることができます。

![](../../.gitbook/assets/2%20%287%29.png)

## プラグインを使用する: Generate String Lights

_この優れたプラグインを使用すると、線分または曲線に基づいてモデルに吊り下げ照明をすばやく追加できます。_

1 - 新しい照明を追加する前に、モデル内の作成済みのシーンを使用して、意図した結果を確認します。

1. 既にストリング ライトを含んだシーンにジャンプするには、**[シーン]パレット**を開き、**Eye Level - Short Alley** という名前のシーンをダブルクリックします。
2. このモデルのストリング ライトに注目してください。これが今から作成する照明ですが、こことは別の場所に配置します。
3. **[レイヤ]パレット**でレイヤ **Helper Geometry** をオンにすると、これらのストリング ライトの生成に使用された元の線分を確認できます。

![](../../.gitbook/assets/3%20%2810%29.png)

2 - 別の路地にナビゲートして、照明を追加します。**[シーン]パレット**でシーン **Eye Level - Long Alley** を開きます。この路地にはまだストリング ライトがありません。

3 - 照明用の新しいストリングを作成します。

1. ストリング ライトのアイコンをクリックして、新しくインストールした **Generate String Lights** のパレットを開きます。既定では、新しいプラグインのアイコンは下の方に表示されています。
2. **[Number of Fixtures]**オプションを **10** に変更します。
3. ヘルパー線分のいずれかをダブルクリックして、作成済みのグループ **String Lights – Long Alley** を編集します。次に、描画済みのヘルパー線分のいずれかをシングルクリックして選択します。
4. プラグインのパレット内の**[Generate String Lights]**ボタンをクリックすると、新しい照明用のストリングが表示されます。照明の各ストリングは、独自の一意のグループとして作成されます。

![](../../.gitbook/assets/4%20%286%29.png)

_**注:**_ _一部の線分が「Groove Coffee」の看板を通り抜けても構いません。ストリング ライトのプラグインでは、看板の下にリアルに垂れ下がるカテナリー曲線が作成されるためです。_

4 - 他の既成のヘルパー線分を使用して、さらにストリング ライトを作成したり、独自のヘルパー線分を作成してみてください。プラグインの設定を変えると、異なる結果が得られます。

5 - モデルを整理された状態に保つため、完了したときに、すべてのヘルパー線分をグループ化してレイヤ **Helper Geometry** に置き、ストリング ライトのすべてのグループをレイヤ **Context - Exterior Lighting** に割り当てることをお勧めします。これで、ヘルパー線分が不要なすべての「Eye Level」シーンで非表示にすることができます。完了すると、次のような結果になります。

![](../../.gitbook/assets/5%20%283%29.png)

_**注:**_ _Dynamo スクリプトで作成されたジオメトリは_ _**[プロパティ]パレット**を使用して更新および再生成できますが、プラグインで作成されたオブジェクトはほとんどの場合、FormIt の通常のジオメトリです。そのため、作成後に編集する場合は、FormIt の組み込みモデリング ツールを使用する必要があります。_

## Manage Cameras プラグイン

_FormIt Primer では全般的に、モデル全体の表示をナビゲートおよびコントロールするための便利なツールとしてシーンを使用しています。このプラグインを使用すると、現在のカメラの高さを表示および編集したり、各シーンのカメラを 3D オブジェクトとして書き出したり、これらのシーンをモデル間でコピーできます。_

1 - 最初に、カメラが実際に視点レベルになるように、シーン **Eye Level - Long Alley** を調整します。

1. このシーンが表示されていない場合は、**[シーン]パレット**内でシーン **Eye Level - Long Alley** をダブルクリックして戻ります。
2. 歯車付きカメラのアイコンをクリックして、**Manage Cameras** パレットを開きます。
3. **[Height Above Ground]**を **5'-8"** に変更します。

![](../../.gitbook/assets/6%20%286%29.png)

_**注:**_ _モデルにレベルがある場合、このプラグインでは_ _**Main Camera**より下の最も近いレベルからの高さも表示されます。_

2 - 次のように操作します。

1. **[シーン]パレット**に戻ります。
2. シーン **Eye Level – Long Alley** が選択されたままになっていることを確認します(選択されていない場合は、シングルクリックで選択します)。
3. **[シーンを更新]**ボタンをクリックして、このシーンに新しいカメラの高さを保存します。

![](../../.gitbook/assets/7%20%281%29.png)

_**注:**_ _シーンのカメラの角度と位置を調整する場合は、_ _**[シーン カメラを編集]**_ _ボタン\(_ _**[シーン]パレット**_ _上部の更新ボタンと再生ボタンの間にあるボタン\)に切り替えます。_

3 - 次に、シーンを新しいモデルに書き出します。まず、**Manage Cameras** プラグインを使用してすべてのシーンのカメラ オブジェクトを作成します。

1. **[Manage Cameras]パレット**を再度開きます。
2. **[Copy Cameras to Clipboard]**オプションがオンになっていることを確認します。
3. **[Export Scenes to Cameras]**ボタンをクリックします。これは数秒かかる場合があります。
4. キャンバス全体が白くなった場合は、**Main Camera** がシーンのカメラの 1 つに位置合わせされています。**[ズーム\(Z\)]**で縮小して、3 つの主要な建物と新しく作成されたカメラ オブジェクトが表示されるようにします。カメラ オブジェクトは自動的に **Cameras** という名前の 1 つの大きなグループに配置されます。このグループ内では、個々のカメラは作成元のシーンと同じ名前の独自のグループに配置されます。

![](../../.gitbook/assets/8%20%287%29.png)

4 - これらのシーンを新しいモデルにコピーします。カメラ データがクリップボードに保存されたため、後は次のように操作するのみです。

1. 現在のモデルを**[保存** **\([Ctrl] + [S]\)]** して閉じます。
2. **[メイン メニュー]**バーの**[ファイル]**ドロップダウンから**[新しいスケッチ\([Ctrl]+[N]\)]**を選択して、新しい空のスケッチを開始します。
3. **Manage Cameras** プラグインが開いていない場合は開き、**[Look for Cameras on Clipboard]**オプションがオンになっていることを確認します。
4. プラグインの下部近くの**[Import Scenes from Cameras]**ボタンをクリックすると、他のモデルのシーンが読み込まれます。確認するには、**[シーン]パレット**を開くか、レイヤ **Camera** をオンにします。シーンと 3D カメラ オブジェクトがすべてこのモデルに読み込まれたことがわかります。

![](../../.gitbook/assets/9%20%287%29.png)

## Properties Plus プラグイン

_このプラグインは、標準の_ _**[プロパティ]パレット**の機能が強化されたものです。複数のグループやジオメトリのタイプを選択すると、このプラグインによって選択した内容の詳細情報が表示され、グループやグループ インスタンスの名前を一括で変更できます。_

1 **-** まず、メイン モデルのドア グループのプロパティを確認します。**Encode Campus Sample Model.axm** を再度開いて、シーン **Eye Level - Long Alley** に戻ります。**Properties Plus** プラグインの使用を開始するには、次のように操作します。

1. プラス記号が付いたアイコンをクリックして、**[Properties Plus]パレット**を開きます。
2. **[Update on Selection Change]**がオンになっていることを確認します。
3. 路地の右側にある、「**Door**」という名前の両開きガラス ドアのグループを選択します。
4. **[Selection Count]**セクションの**[Total Objects]**は、**1** つのオブジェクトが選択されていることを示しています。
5. この下に、選択されているオブジェクトのタイプに関する詳細が表示されます。この例では、**1** つのグループが選択されていますが、そのグループにはモデル内のどこかに **4** つのインスタンスがあります。

![](../../.gitbook/assets/10%20%282%29.png)

_**注:**_ _選択したグループのインスタンス数を確認すると、たとえば実際に変更するのは選択した要素のみであるのに、最初に一意にしておくのを忘れたために複数の要素を誤って変更してしまうというトラブルを防ぐことができて、非常に便利です。_

2 - このプラグインを使用すると、グループ編集モードに切り替えずにグループまたはグループ インスタンスの名前を編集できます。また、複数のインスタンスの名前を一度に変更することもできます。前に学習したように、すべてのグループに名前がありますが、そのグループのすべてのインスタンスに一意のインスタンス名を付けることもできます。このモデルには多くのタイプのドアが含まれている可能性が高いため、このグループと、そのインスタンスの一部に、より具体的な名前を付けます。

1. 最初のガラスのグループ **Door** を選択したままの状態で、現在の選択に別の **Door** グループを追加するには、**[Shift]**または**[Ctrl]**を押しながら最初のグループの近くにある別の両開きガラスのグループ **Door** をクリックします。
2. **[Properties Plus]パレット**の**[Selection Count]**が更新され、選択されているインスタンスは **2** つであるが、選択されている一意の **ファミリ**(つまりグループ)は **1** つのみであることが示されます\(このプラグインでは、Revit ユーザに馴染みのある「**ファミリ**」という用語が使用されていますが、ここでは FormIt のグループのことです\)
3. **[Group Family]**セクションで、**[Name]**フィールドを「**Doors - Double Glass Storefront**」に更新します。これにより、すべてのインスタンスのグループの名前が、配置されている場所や現在選択されているかどうかに関係なく更新され、グループをダブルクリックして編集する必要がなくなります。
4. これらの 2 つのインスタンスは両方とも Groove Coffee の建物に入るドアであるため、**[Multiple Group Instances]**セクションの**[Name]**フィールドに「**Groove Coffee Door**」と入力して、これらの 2 つのインスタンスのみの名前を変更します。

**注:** 標準の**[プロパティ]パレット**では、1 つのグループの複数のインスタンスの名前を一度に変更することはできません。このプラグインは、名前が同じ数十または数百のインスタンスの名前を一度に変更する場合に非常に便利です。

![](../../.gitbook/assets/11%20%286%29.png)

_**注:**_ _マウスをパレットから離すと、選択したテキストボックスを編集できなくなります。これは、すべてのパレットに当てはまります。そのため、パレット内で編集する際は、カーソルをパレットの内側に置いておいてください。_

3 - Groove Coffee のガラス ドアまたは別のガラス ドアを選択し、標準の**[プロパティ]パレット**でそのプロパティを確認すると、**グループ**の名前はすべてのインスタンスで更新されていますが、Groove Coffee のドアだけは、インスタンスの**名前**が既定値から更新されています。

![](../../.gitbook/assets/12%20%283%29.png)

4 - 最後に、このプラグインによるさまざまなタイプの要素の並べ替えを確認します。

1. モデル内の任意の場所に、**線分\(L\)**、**長方形\(R\)**、**立方体\([Alt]+[B]\)**を簡単に描画します。これらは一時的に使用するため、正確に配置する必要はありません。
2. **[Properties Plus]パレット**が閉じている場合は再度開き、**[Ctrl]+[A]**を押してモデル内の表示されているすべての要素を選択します。
3. **[Selection Count]**セクションでは、選択した要素が **Edges** (線分)、**Faces**、**Bodies** \(面とエッジから構成される立方体などの 3D シェイプ\)**、** **Groups** などに分類されています。

![](../../.gitbook/assets/13%20%283%29.png)

_**注:**_ _このプラグインによって_ _**頂点**も検出されます。これは、_ _**Generate Vertex**という別のプラグインを使用して作成できます。試す場合は、_ _**Generate Vertex プラグイン**_ _をインストールし、上記の手順を繰り返します。_

## Plugin Playground

_FormIt では、世界中のユーザや開発者向けに、独自のカスタム プラグインを FormIt 内で作成およびテストできるプラグインも用意されています。このツールを最大限に活用するには HTML、CSS、JavaScript に関する知識が必要であるため、ここでは詳しく説明しませんが、関心をお持ちの場合には、「_ [_**FormIt JavaScript プラグインを作成する\(英語\)**_](https://formit3d.github.io/FormItExamplePlugins/docs/HowToBuild.html)_」で詳細を確認できます。_

1 - **Plugin Playground** は、これまでのプラグインをインストールした場合と同じ方法で**[プラグイン]パレット**からインストールできます。

2 - **Plugin Playground** の基本的な概要を次に示します。

1. __鉛筆__のアイコンをクリックして **[Plugin Playground]パレット**を開きます。
2. パレット内で**[Edit]**ボタンをクリックし、カスタム プラグインを作成するための組み込みのコード エディタを開きます。このプラグインには、立方体を作成するプラグインのコードが既にロードされています。
3. **[Play]**ボタンをクリックすると、現在のコードがテストとして実行されます。この例では、立方体作成用プラグインの内容がパレットに表示されます。

![](../../.gitbook/assets/14%20%283%29.png)

