# 2.6 - Nodi di Dynamo in FormIt

_FormIt è dotato di una libreria di nodi di Dynamo che trasferiscono la geometria tra FormIt e Dynamo. Nei capitoli precedenti abbiamo illustrato come creare e regolare dinamicamente gli oggetti di Dynamo all'interno di FormIt. In questo capitolo, modificheremo un grafico di Dynamo fornito per creare una versione modificata del grafico della scala predefinito._

_Per questo capitolo, utilizzeremo sia il modello_ _**Encode Campus Sample Model.axm**_ _sia_ _lo script di Dynamo_ _**Scale by Top Edge.dyn**_ _. Se non è già stato fatto, è possibile trovare entrambi i file scaricando il_ _**set di dati della Parte II della Guida introduttiva di FormIt**._

_Se non si conosce l'utilizzo di Dynamo all'interno di FormIt, consigliamo di completare il capitolo_ _**1.10 -**_ _**Gruppi computazionali con Dynamo**_ _nella_ _**Parte I**_ _di questa Guida introduttiva. Sebbene questo capitolo includa la modifica dei grafici di Dynamo, tratteremo effettivamente solo gli elementi di Dynamo correlati ai nodi specifici di FormIt. Se non si conosce Dynamo, è possibile ottenere ulteriori informazioni visitando la pagina_ [_**Dynamo Primer**_](https://primer.dynamobim.org/it/01_Introduction/1-2_what_is_dynamo.html)_**.**_

_**Per questa sezione è necessario disporre di FormIt per Windows 2022.0 o versione successiva.**_

## **Aggiunta di una posizione della libreria di Dynamo**

_Sebbene FormIt sia dotato di una libreria di grafici predefiniti nella cartella **Dynamo Samples**, è necessaria una posizione in cui creare e salvare i grafici personalizzati. A tale scopo, desideriamo innanzitutto aggiungere una nuova cartella a **Posizioni libreria di Dynamo** di FormIt. Ciò è simile all'aggiunta di una cartella alla libreria del contenuto di FormIt, pertanto se è necessario un ripasso, consultare la Parte I della Guida introduttiva, capitolo **1.11 - Importazione di modelli con Libreria del contenuto**._

1 - Per aggiungere una nuova **posizione della libreria di Dynamo**:

1. Con **Encode Campus Sample Model.axm** aperto, accedere alla **tavolozza di Dynamo**.
2. Fare clic sul pulsante **Collega directory di Dynamo** nell'angolo superiore sinistro.
3. Viene visualizzata la finestra **Preferenze**, con la scheda **Dynamo** automaticamente selezionata. Fare clic sull'icona "più" **Aggiungi una nuova posizione della libreria di Dynamo**.
4. Individuare la posizione in cui è stato scaricato il **set di dati del modello Encode** e selezionare la cartella **Support Files** &gt; **FormIt Primer Graphs**.
5. Fare clic su **Seleziona cartella**, quindi su **OK** per tornare a FormIt.
6. Nell'elenco a discesa della cartella nella parte superiore della **tavolozza di Dynamo**, selezionare la cartella **FormIt Primer Graphs** appena aggiunta.

![](../../.gitbook/assets/0%20%2821%29.png)

##  **Nodo** **SendToFormIt**

_Affinché qualsiasi grafico di Dynamo funzioni con FormIt, deve disporre di almeno un nodo_ _**SendToFormIt**_ _._

1 - Iniziamo provando ad utilizzare il grafico **Stair by Top Edge** così com'è, dalla cartella appena aggiunta.

1. Iniziare accedendo alla scena Section - Longitudinal.

2 - Aggiungeremo il nodo **SendToFormIt** al grafico. A tale scopo, utilizzeremo Modifica grafico di origine in un nuovo modello di FormIt, in modo da non "inquinare" il modello di lavoro con le modifiche apportate alla creazione del grafico.

1. Fare clic con il pulsante destro del mouse sull'**icona di FormIt** sulla barra delle applicazioni e selezionare **FormIt** per aprire una nuova finestra vuota di FormIt \(oppure è sufficiente fare clic con il pulsante centrale del mouse sull'icona di FormIt\).
2. Nella **tavolozza di Dynamo**, individuare il riquadro **Stairs by Top Edge** e fare clic sulla piccola freccia a discesa sul bordo destro del riquadro o fare clic con il pulsante destro del mouse sul riquadro stesso.
3. Selezionare **Modifica grafico di origine**. In questo modo si avvia automaticamente Dynamo e si apre il grafico che si desidera modificare.

![](../../.gitbook/assets/2%20%2822%29.png)

2 - Una volta aperti Dynamo e il grafico, eseguire lo zoom avanti dell'area mostrata qui di seguito, contenente i gruppi verde e viola più a destra.

![](../../.gitbook/assets/3%20%2819%29.png)

_**Nota**_ _I grafici di Dynamo vanno da sinistra a destra, pertanto in genere i nodi di output si trovano all'estrema destra del grafico._

3 - Ora dobbiamo aggiungere un nodo **SendToFormIt** per inviare la geometria della scala visualizzata sullo sfondo al nostro modello di FormIt:

1. Nell'area Moduli aggiuntivi \(pacchetti\) a sinistra, espandere l'elenco a discesa **FormIt** e fare clic su **SendToFormIt**. Al centro dello schermo verrà visualizzato un nodo **SendToFormIt**.
2. Aggiungere il nuovo nodo al gruppo viola **Send Stair Geometry to FormIt** selezionando sia il gruppo viola sia il nuovo nodo **SendToFormIt**, quindi fare clic con il pulsante destro del mouse sul nodo **SendToFormIt** e selezionare **Aggiungi al gruppo**. Spostare il nuovo nodo in una posizione simile a quella mostrata nell'immagine riportata di seguito.
3. Fare clic con il pulsante destro del mouse sul nodo **SendToFormIt** e verificare che l'opzione **È output** sia selezionata. Dovrebbe essere impostata per default, ma se non lo è, non verrà inviata alcuna geometria a FormIt.
4. Rinominare il nodo **SendToFormIt** in **SendToFormIt.Stairs**.
5. Collegare i due \(2\) input del nuovo nodo **SendToFormIt.Stairs** come mostrato nell'immagine riportata di seguito.

![](../../.gitbook/assets/4%20%2818%29.png)

_**Nota**_ _Sebbene stiamo utilizzando solo il nodo delle opzioni_ _**SetAsMesh**__, che determina se la geometria viene inviata a FormIt come oggetto o come mesh,_ _sono disponibili diversi nodi_ _FormItGroupOptions****__. Ognuno controlla diverse proprietà della geometria inviata a FormIt; è possibile provare ad utilizzarne alcune delle altre._

4 - Torniamo a FormIt e vediamo se ha funzionato:

1. Salvare e chiudere Dynamo. Il grafico aggiornato verrà ricaricato automaticamente in FormIt.
2. Tornare alla finestra di FormIt con il **file di esempio del campus encode** e nella **tavolozza di Dynamo**, fare nuovamente clic su **Stair by Top Edge**.
3. Posizionare la scala nel modello, analogamente a quanto mostrato nell'immagine riportata di seguito.
4. Selezionare la scala e osservare che il nome del gruppo corrisponde al nome del grafico di Dynamo.
5. Ora, fare doppio clic per modificare il gruppo e selezionare il gruppo della geometria della scala nidificato. Notare che il nome di quel gruppo corrisponde al nome assegnato al nodo in Dynamo.

![](../../.gitbook/assets/5%20%2817%29.png)

_**Nota**_ _Non importa la posizione esatta della scala; la regoleremo nella seguente sezione._

![](../../.gitbook/assets/6%20%2814%29.png)

_**Nota**_ _In questo caso era necessario un solo nodo_ _**SendToFormIt**_ _, ma è possibile crearne di più. Ciascuno creerà un nuovo gruppo in FormIt, in base al nome del nodo_ _**SendToFormIt**_ _da cui proviene._

## **Nodi SelectFromFormIt**

_Come abbiamo visto nei capitoli precedenti, i grafici di Dynamo possono richiedere all'utente di selezionare una geometria specifica, che viene quindi utilizzata dal grafico. Ora aggiungeremo due \(2\) di questi nodi al nostro grafico della scala, in modo che l'orientamento, la larghezza e l'altezza delle scale possano essere calcolati dalla geometria di FormIt selezionata all'interno di Dynamo._

1 - Eliminare la scala appena posizionata.

2 - Tornare alla finestra vuota di FormIt.

3 - Nella **tavolozza di Dynamo**, fare clic sull'elenco a discesa per il riquadro **Stairs by Top Edge** e selezionare **Modifica grafico di origine**, che verrà aperto di nuovo in Dynamo.

_**Nota**_ _Se si modifica un grafico di Dynamo direttamente dalla relativa_ _**tavolozza Proprietà**_ _facendo clic su_ _**Modifica grafico incorporato**_ _\(anziché dalla_ _**tavolozza di Dynamo**\), si modificherà il grafico incorporato solo per quel gruppo e non il grafico di origine salvato nella cartella aggiunta in precedenza alla libreria di Dynamo di FormIt._

4 - Questa volta, desideriamo aggiungere alcuni nodi di selezione, che si trovano all'inizio, a sinistra o al lato del grafico. Eseguire lo zoom avanti dell'area mostrata di seguito.

![](../../.gitbook/assets/7%20%289%29.png)

5 - Per aggiungere i nuovi nodi di selezione:

1. Nell'area **Moduli aggiuntivi**, espandere **FormIt** e fare clic due volte su **SelectFromFormIt**; si dovrebbero creare due \(2\) nuovi nodi al centro dello schermo.
2. Disporli uno sopra l'altro come mostrato nell'immagine riportata di seguito, creare un gruppo arancione specifico e denominarlo **Geometry Selected from FormIt**. L'ordine in cui viene richiesto all'utente di selezionare elementi in FormIt si basa sul posizionamento verticale dei nodi di selezione in Dynamo; il nodo più in alto verrà visualizzato per primo e quello più in basso verrà visualizzato per ultimo.
3. Rinominare il nodo superiore **Select Top Edge** e il nodo inferiore **Select Bottom Floor**. Quando questo grafico viene eseguito in FormIt, sarà visualizzata una procedura guidata di selezione di Dynamo. Si utilizzeranno i nomi di questi nodi come messaggi di richiesta per la geometria da selezionare.
4. Fare clic con il pulsante destro del mouse su ciascun nodo e verificare che sia selezionata l'opzione **È input**. Dovrebbe essere selezionata per default, ma in caso contrario, questi nodi non verranno riconosciuti da FormIt.
5. Collegare i nuovi nodi di selezione come mostrato nell'immagine riportata di seguito. Ognuno di essi dispone di un solo \(1\) collegamento.

![](../../.gitbook/assets/8%20%2811%29.png)

_**Nota**_ _I nuovi nodi potrebbero mostrare avvisi, che diventeranno di colore giallo come si è visto sopra. È possibile ignorarli per ora. Gli avvisi sono dovuti al fatto che i nodi prevedono geometria derivante da FormIt, ma non è stata ancora ricevuta \(perché li abbiamo appena aggiunti\)._

6 - Ora dobbiamo apportare qualche altra modifica al grafico, in modo che le scale vengano create dalla geometria dei nodi di selezione. Innanzitutto, abbiamo bisogno di modificare gli input **Floor-to-Floor Height** e **Stair Width** in modo che i relativi valori vengano ricavati dalla geometria selezionata anziché dai dispositivi di scorrimento di input:

1. Tenendo premuto **MAIUSC**, fare clic sull'output del nodo **Floor-to-Floor Height** all'interno del gruppo **Slider Inputs** arancione e spostare tali fili nell'output del nodo **Calculated Floor-to-Floor Height** appena sopra.
2. Utilizzando la stessa tecnica, spostare i fili di output da **Stair Width** nel gruppo **Slider Inputs** arancione all'output del nodo **Calculated Floor-to-Floor Height** sopra.
3. Eliminare i nodi **Floor-to-Floor Height** e **Stair Width** precedenti, poiché non saranno più necessari.

![](../../.gitbook/assets/9%20%288%29.png)

_**Nota**_ _Se si desidera aggiungere eventuali_ _nodi di input di Dynamo al grafico, la procedura è molto simile all'aggiunta dei nodi_ _**SelectFromFormIt**_ _. È sufficiente assicurarsi che siano contrassegnati come_ _**È input**, rinominarli e riordinarli come si desidera visualizzarli in FormIt; verranno visualizzati nella_ _**tavolozza Proprietà** di FormIt._

7 - Infine, eseguire lo zoom sull'estremità destra del grafico, dove abbiamo aggiunto il nodo **SendToFormIt.Stairs** in precedenza. Desideriamo cambiare questo nodo di output per utilizzare la geometria della scala che è stata spostata e ruotata in base alla geometria selezionata nella posizione di FormIt. È sufficiente passare per il collegamento dal gruppo **Stair Geometry** al gruppo **Rotated and Translated Stair Geometry**.

![](../../.gitbook/assets/10%20%288%29.png)

## **Utilizzo del grafico**

1 - Ora che abbiamo aggiunto sia i nodi di selezione che quelli di bake, il grafico è pronto. Salvare e chiudere Dynamo, quindi tornare alla finestra di FormIt con **Encode Campus Sample Model.axm** e provare ad effettuare le seguenti operazioni:

1. Assicurarsi di trovarsi ancora nella scena **Section – Longitudinal**, quindi disegnare una linea di 6' lungo il bordo destro dell'apertura della scala al primo piano. In questo modo si definiranno la larghezza e l'angolo della scala.
2. Nella **tavolozza di Dynamo**, fare clic sul riquadro **Stairs by Top Edge** per avviare il grafico.
3. Verrà visualizzata una procedura guidata di selezione di Dynamo e verrà richiesto di effettuare la prima selezione utilizzando il nome assegnato a quel nodo di selezione in precedenza, **Select Top Edge**. Dopo aver selezionato il bordo appena disegnato, fare clic sulla freccia avanti nella procedura guidata di selezione di Dynamo.
4. Il messaggio di richiesta successivo sarà il nome dell'altro nodo di selezione, **Select Bottom Floor**. Selezionare il solaio del piano terra dell'edificio principale encode, quindi fare clic sul segno di spunta.
5. Dopo aver creato la scala, notare che nella **tavolozza Proprietà** è ora possibile selezionare nuovamente la geometria per uno dei due nodi di selezione. Inoltre, i dispositivi di scorrimento corrispondenti ai nodi di input eliminati, **Floor-to-Floor Height** e **Stair Width**, non sono più presenti. Vengono ora calcolati dalla geometria selezionata.

![](../../.gitbook/assets/11%20%288%29.png)

_**Nota** Se si modifica la posizione del bordo superiore o l'altezza del pavimento inferiore e si riesegue il grafico, le scale verranno aggiornate di conseguenza. In genere è consigliabile evitare di spostare manualmente qualsiasi geometria generata da Dynamo che dipende dalle selezioni di FormIt, in quanto ciò può modificarne la relazione con la geometria selezionata utilizzata per crearla. Talvolta, il raggruppamento del gruppo di Dynamo e della geometria di selezione consentirà di mantenere il collegamento ed evitare eventuali problemi._

2 - Per concludere, è possibile aggiungere i tocchi finali. Abbiamo effettuato quanto segue, utilizzando vari strumenti descritti nei capitoli precedenti:

1. È stata creata una scala su ciascun piano.
2. È stato ruotato leggermente il bordo superiore della scala inferiore per creare una scala leggermente diagonale sul piano terra.
3. Sono stati leggermente modificati alcuni dispositivi di scorrimento di input per ciascuna scala per ottenere le impostazioni desiderate.
4. È stato utilizzato il grafico di Dynamo **Railing Along Path** per creare pianerottoli attorno alle aperture della scala.
5. È stato aggiunto un montante centrale per ciascuna scala utilizzando **Estrusione su percorso**.
6. Tutte le scale, le stringhe e la ringhiera sono state posizionate su un nuovo layer denominato **Encode Main Building – Stairs**.

![Scale completate, viste in sezione.](../../.gitbook/assets/12%20%287%29.png)

![Scale completate, com'è visibile nella scena Eye Level &#x2013; Plaza.](../../.gitbook/assets/13%20%287%29.png)



